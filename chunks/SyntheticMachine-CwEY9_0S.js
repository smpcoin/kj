import{r,i as M,u as S,l as w,p as C,j as e,B as x,I as A,q as c,s as B,v as I}from"./vendor-CR9QeBO-.js";import{a as k}from"./arrow-Dt4f_FJz.js";import{A as u,N as h}from"./index-CwKQTuFo.js";import{c as o}from"../assets/index-Ciym-nWW.js";import{S as L,P as E,C as X}from"./index-URfKUYQd.js";import{M as T}from"./MiningMachineSystemStorage-DvDQZY6X.js";import{M as P}from"./MiningMachineProductionLogic-71W66ing.js";import"./helper-CPLEapGt.js";const q="/assets/calculator-BJs_23v8.svg",G=()=>{const[l,d]=r.useState(!1),p=M(),[t,a]=r.useState(""),{address:m}=S(),[n,f]=r.useState(""),g=s=>{a(s)},b=()=>{p("/user")},N=()=>{const s=Math.floor(+n/80);s>10?a("10"):a(s===0?"":String(s))},i=r.useCallback(async()=>{try{const s=await w(o,{address:L,abi:T,functionName:"mixBalances",args:[m]});f(C(s))}catch(s){console.error(s)}},[m]);r.useEffect(()=>{i()},[i]);const j=async()=>{if(+t==0||t===""){c.show({content:"至少合成1台矿机",position:"center"});return}try{d(!0);const s=await B(o,{address:E,abi:P,functionName:"mixToChildMachine",args:[t]});await I(o,{hash:s,chainId:X}),c.show({content:"合成成功",position:"center"}),i(),a("")}catch(s){c.show({content:"合成失败",position:"center"}),console.error(s)}finally{d(!1)}},v=()=>{if(t!==""&&t!=="0"&&(+t>10||+n<80*+t))return!0},y=()=>{if(t!==""&&t!=="0"){if(+t>10)return"每次最多10台";if(+n<80*+t)return"余额不足"}return"合成"};return e.jsxs("div",{className:"px-[21px]",children:[e.jsxs("div",{className:"flex pt-4",children:[e.jsx(x,{onClick:b,className:"!p-[0] !rounded-2xl",loading:l,children:e.jsx("img",{src:k,alt:""})}),e.jsx("span",{className:"m-auto text-[17px] font-bold text-black",children:"合成矿机"})]}),e.jsxs("div",{className:"bg-black rounded-t-2xl text-white p-[21px] mt-6",children:[e.jsx("div",{children:"我的MIX积分"}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx(u,{type:h.BALANCE,value:n,decimalSubLen:2,className:"font-bold text-[26px] mr-2"}),"MIX"]})]}),e.jsxs("div",{className:"bg-white rounded-b-2xl flex justify-center items-center py-6 gap-[40px]",children:[e.jsx("div",{className:"rounded-[12px] p-2.5 border border-[#bebebe]",children:e.jsx("img",{src:q,alt:"",className:"w-[.9375rem]"})}),e.jsx("div",{className:"text-[.875rem]",children:"80MIX积分 = 1台矿机"})]}),e.jsxs("div",{className:"bg-white p-[21px] rounded-2xl mt-6",children:[e.jsxs("div",{className:"text-[14px] font-bold mb-4",children:["合成矿机数量",e.jsx("span",{children:"（每次至多10个）"})]}),e.jsx("div",{className:"items-center",children:e.jsxs("div",{className:"relative",children:[e.jsx(A,{placeholder:"输入整数",className:"!bg-[#f3f3f3] rounded-3xl px-4 py-1.5",value:t,type:"number",onChange:g,style:{"--font-size":"14px"}}),e.jsx("span",{onClick:N,className:"absolute right-[2.5rem] top-[.5625rem] text-[8px] bg-[#895eff] text-white px-2 py-0.5 rounded-3xl",children:"MAX"}),e.jsx("span",{className:"absolute right-[1.25rem] top-[.4375rem] text-[.875rem]",children:"台"})]})}),e.jsxs("div",{className:"text-end mt-4 text-[.75rem]",children:["余额：",e.jsx(u,{type:h.BALANCE,value:n,decimalSubLen:2,className:"font-bold text-[1rem] mr-2"}),"MIX积分"]}),e.jsx("div",{className:"mt-8",children:e.jsx(x,{onClick:j,loading:l,className:"!bg-black !text-white !rounded-3xl !ml-auto !py-2 !w-full ",disabled:v(),style:{fontSize:"14px"},children:y()})})]})]})};export{G as default};
