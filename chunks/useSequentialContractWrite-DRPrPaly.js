import{n as d,u as m,r as g,v as C}from"./vendor-CR9QeBO-.js";import{c as h}from"../assets/index-9QO47Yxg.js";function x(){const{writeContractAsync:l}=d(),{chain:n}=m();return{executeSequentialCalls:g.useCallback(async a=>{var r,u;if(!(n!=null&&n.id))throw new Error("No connected chain");const o=[];for(let c=0;c<a.length;c++){const t=a[c],f={functionName:t.functionName,callIndex:c};try{console.log(`Executing call ${c+1}/${a.length} to ${t.functionName}...`);const e=await l({address:t.address,abi:t.abi,functionName:t.functionName,args:t.args||[],value:t.value||BigInt(0),chainId:n.id});console.log(`Waiting for confirmation of call ${c+1} (${t.functionName})...`);const s=await C(h,{hash:e});if(t.onConfirmed)try{await t.onConfirmed(s,c)}catch(i){console.error(`onConfirmed callback failed for call ${c+1}:`,i)}o.push({...f,success:!0,txHash:e,receipt:s}),console.log(`Call ${c+1} (${t.functionName}) confirmed with txHash: ${e}`)}catch(e){if(((e==null?void 0:e.name)==="UserRejectedRequestError"||(e==null?void 0:e.code)===4001||((r=e==null?void 0:e.message)==null?void 0:r.includes("User rejected"))||((u=e==null?void 0:e.message)==null?void 0:u.includes("用户拒绝")))&&t.onCancel)try{await t.onCancel(c,e)}catch(i){console.error(`第 ${c+1} 个调用的 onCancel 回调失败:`,i)}o.push({...f,success:!1,error:e})}}return o},[l,n==null?void 0:n.id])}}export{x as u};
