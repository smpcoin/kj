import{K as A,A as r,u as C,i as I,r as a,j as e,B as c,F as L,s as k,v as H,q as T}from"./vendor-CR9QeBO-.js";import{a as B}from"./arrow-Dt4f_FJz.js";import{u as E}from"./user-machine-DxW_ZeqC.js";import{L as M,C as F}from"./index-Cobmn13i.js";import{s as v,f as g}from"./helper-CPLEapGt.js";import{c as j}from"../assets/index-Bvj3I4S-.js";import{o as z}from"./orderStore-CEoCXZ7c.js";import{M as R}from"./MiningMachineSystemLogic-BvMT4rBv.js";const W=()=>{const t=A().state,l=15-r(new Date().getTime()/1e3).diff(t.listedAt,"day"),i=t.listedAt*1e3,u=r(i).add(15,"day"),x=r().isAfter(u),{address:N}=C(),d=z.getOrders().filter(s=>s.seller===N&&s.status===1&&s.orderType===3),n=I(),[h,b]=a.useState(0),m=a.useRef(null),[f,p]=a.useState(!1),w=()=>{n("/user")};a.useEffect(()=>{if(!m.current)return;const s=()=>{const S=window.innerHeight-354;b(S)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const y=async()=>{try{p(!0);const s=await k(j,{address:M,abi:R,functionName:"cancelListedChildMachine",args:[t.orderId]});await H(j,{hash:s,chainId:F}),T.show({content:"下架成功",position:"center"}),n("/user")}catch(s){console.error(s)}finally{p(!1)}},D=()=>{n("/user/sellToPlatform",{state:t})};return e.jsxs("div",{className:"px-[21px]",children:[e.jsxs("div",{className:"flex pt-4 mb-4",children:[e.jsx(c,{onClick:w,className:"!p-[0] !rounded-2xl",loading:f,children:e.jsx("img",{src:B,alt:""})}),e.jsx("span",{className:"m-auto text-[19px] font-bold",children:"我的挂售"})]}),e.jsxs("div",{className:"p-[15px] bg-white rounded-3xl",children:[e.jsxs("div",{className:" flex gap-2",children:[e.jsx("img",{src:E,alt:"",width:50}),e.jsxs("div",{className:"flex text-[11px] flex-1",children:[e.jsxs("div",{className:"w-[60px] flex flex-col gap-1 text-[#5B5B5B]",children:[e.jsx("div",{children:"出售中"}),e.jsx("div",{children:"矿机卖家:"}),e.jsx("div",{children:"上架时间:"})]}),e.jsxs("div",{className:"ml-auto w-[73%] font-bold flex flex-col gap-1",children:[e.jsx("div",{children:"..."}),e.jsx("div",{children:v(t.seller,4)}),e.jsx("div",{className:"text-[11px]",children:g(t.listedAt)})]})]}),e.jsx("div",{className:"flex text-[12px]",children:e.jsxs("div",{className:"flex flex-col justify-between items-center",children:[e.jsx("div",{className:"bg-[#895EFF] rounded-2xl px-2 text-white ",children:"我发布的"}),e.jsxs("div",{className:"text-[#895EFF]",children:["NO.",t.NO]})]})})]}),e.jsxs("div",{className:"mt-6 relative",children:[e.jsxs("div",{className:"flex gap-2 mb-2 ",children:[e.jsx(c,{loading:f,onClick:y,className:"flex-1 !rounded-3xl !border-2 !border-dashed !border-[#e1e1e1]",style:{fontSize:"14px",padding:"5px"},children:"下架"}),e.jsxs(c,{disabled:!x,onClick:D,className:"flex-1 !rounded-3xl !border-2 !border-dashed !border-[#e1e1e1] ",children:["卖给平台",!x&&e.jsxs("div",{className:"absolute top-[-20px] right-0 bg-[#3D3B42] rounded-[5px] text-white text-[12px] px-2 py-0.5",children:[l,"日后可售卖"]})]})]}),e.jsx("div",{className:"text-[#6D6D6D] text-[12px] text-center ",children:"15天未售出，平台支持16U/台等值IDX进行回收"})]})]}),d.length>0&&e.jsx("div",{className:"py-2 pl-4 text-[15px] text-[#595C5C]",children:"交易历史"}),e.jsx("div",{ref:m,style:{height:`${h}px`},className:"no-scrollbar rounded-2xl ",children:e.jsx(L,{height:h,width:"100%",itemCount:d.length,itemSize:152,itemData:d,children:O})})]})},O=({index:o,style:t,data:l})=>{const i=l[o];return e.jsx("div",{style:{...t,height:"110px"},children:e.jsxs("div",{className:"p-[15px] bg-white rounded-3xl flex flex-col gap-1 text-[#777777] relative",children:[e.jsx("div",{className:"bg-[#9b93af] rounded-3xl text-white px-4 py-0.5 absolute right-[20px] top-[15px] text-[12px]",children:"已完成"}),e.jsxs("div",{className:"flex",children:["交易类型：",e.jsx("div",{className:"text-black font-bold",children:"矿机挂售"})]}),e.jsxs("div",{className:"flex",children:["收益单价：",e.jsxs("div",{className:"text-black font-bold",children:[i.priceInIdx," IDX/台"]})]}),e.jsxs("div",{className:"flex",children:["订单数量：",e.jsx("div",{className:"text-black font-bold",children:"1台"})]}),e.jsxs("div",{className:"flex",children:["交易时间：",e.jsx("div",{className:"text-black font-bold",children:g(i.listedAt)})]}),e.jsxs("div",{className:"flex",children:["购买方钱包地址：",e.jsx("div",{className:"font-bold text-black",children:v(i.buyer,4)})]})]})})};export{W as default};
